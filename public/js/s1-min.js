Ybigh={counter:0,timeoutHandle:"",paths:[],current:"",saveSelection:[],counter_hash:[],click_counter:0,blue:null,green:null,red:null,yellow:null,data:null,confirmIndex:0,to_hex:function(e){return hex=e.toString(16),2==hex.length?hex:"0"+hex},clear:function(){Ybigh.$colors.fadeOut(Ybigh.$colors.remove),Ybigh.timeoutHandle=window.setTimeout(function(){"make-bold active"===$("#"+Ybigh.current).attr("class")&&$("#removeSelections").prop("disabled",!1),Ybigh.show(),$(".cl.world").css({"background-color":"white"}),$(".cl.others").css({"background-color":"white"}),$(".cl.activities").css({"background-color":"white"}),$(".cl.himself").css({"background-color":"white"}),Ybigh.blue=null,Ybigh.green=null,Ybigh.red=null,Ybigh.yellow=null},500)},submitCleared:function(){var e={name:Ybigh.current,wordID:123};$.ajax({type:"POST",url:"/symbol",data:JSON.stringify(e),error:function(e,o,t){},success:function(e){console.log(e),$("#"+Ybigh.current).removeClass("make-bold"),$("#removeSelections").prop("disabled",!0),Ybigh.counter>3&&$("#done").prop("disabled",!1).removeClass("dis")}})},startCounter:function(){Ybigh.timeoutHandle=window.setTimeout(function(){Ybigh.show()},500)},show:function(){var e=$("#phone").html();$(".word");let o;Ybigh.$colors=$('<canvas title="Once selections are made, click whitespace to submit current and load the next word" id="can" height="552" width="552"></canvas>'),$("#container").append(Ybigh.$colors.fadeIn()),Ybigh.colorctx=Ybigh.$colors[0].getContext("2d");var t=getAbsoluteBoundingRect(Ybigh.$colors[0]),c=t.left,l=t.top;Ybigh.render(!0),Ybigh.$colors.on("touchstart mouseup",function(t){if(t.preventDefault(),!Ybigh.current)return void alert("Click a term on the right then make selection(s)");let i="true"===e?t.changedTouches[0]:t,r=i.clientX,h=i.clientY,n=parseInt(r-c),a=parseInt(h-l);var g=0;for(g=0;g<Ybigh.paths.length&&!(o=Ybigh.colorctx.isPointInPath(Ybigh.paths[g],n,a));g++);if(o){let e=Ybigh.get_color(i);if("world"==Ybigh.paths[g].objID){let o=Ybigh.colorctx.createLinearGradient(630,0,375,0);o.addColorStop(1,"white"),o.addColorStop(0,"#4f87ff"),Ybigh.colorctx.beginPath(),Ybigh.colorctx.moveTo(550,185),Ybigh.colorctx.lineTo(370,265),Ybigh.colorctx.lineTo(370,300),Ybigh.colorctx.lineTo(550,380),Ybigh.colorctx.closePath(),Ybigh.colorctx.fillStyle=o,Ybigh.colorctx.strokeStyle="#D0D0D0",Ybigh.colorctx.stroke(),Ybigh.colorctx.fill(),Ybigh.click_counter+=1,e.name=Ybigh.current,e.category=8,Ybigh.blue=e,Ybigh.colorctx.setTransform(1,0,0,1,0,0),Ybigh.colorctx.fillStyle="#000000",Ybigh.colorctx.fillRect(e.x-2,e.y-2,4,4),Ybigh.counter_hash.push({count:Ybigh.click_counter,category:e.category})}else if("others"==Ybigh.paths[g].objID){let o=Ybigh.colorctx.createLinearGradient(0,0,0,195);o.addColorStop(1,"white"),o.addColorStop(0,"#0fc14e"),Ybigh.colorctx.beginPath(),Ybigh.colorctx.moveTo(190,50),Ybigh.colorctx.lineTo(270,235),Ybigh.colorctx.lineTo(310,235),Ybigh.colorctx.lineTo(380,50),Ybigh.colorctx.closePath(),Ybigh.colorctx.fillStyle=o,Ybigh.colorctx.strokeStyle="#D0D0D0",Ybigh.colorctx.stroke(),Ybigh.colorctx.fill(),Ybigh.click_counter+=1,e.name=Ybigh.current,e.category=2,Ybigh.green=e,Ybigh.colorctx.beginPath(),Ybigh.colorctx.setTransform(1,0,0,1,0,0),Ybigh.colorctx.fillStyle="#000000",Ybigh.colorctx.fillRect(e.x-2,e.y-2,4,4),Ybigh.counter_hash.push({count:Ybigh.click_counter,category:e.category})}else if("activities"==Ybigh.paths[g].objID){let o=Ybigh.colorctx.createLinearGradient(190,0,0,0);o.addColorStop(1,"#ff5f57"),o.addColorStop(0,"white"),Ybigh.colorctx.beginPath(),Ybigh.colorctx.moveTo(20,185),Ybigh.colorctx.lineTo(200,265),Ybigh.colorctx.lineTo(200,300),Ybigh.colorctx.lineTo(20,380),Ybigh.colorctx.closePath(),Ybigh.colorctx.fillStyle=o,Ybigh.colorctx.strokeStyle="#D0D0D0",Ybigh.colorctx.stroke(),Ybigh.colorctx.fill(),Ybigh.click_counter+=1,e.name=Ybigh.current,e.category=4,Ybigh.red=e,Ybigh.colorctx.setTransform(1,0,0,1,0,0),Ybigh.colorctx.fillStyle="#000000",Ybigh.colorctx.fillRect(e.x-2,e.y-2,4,4),Ybigh.counter_hash.push({count:Ybigh.click_counter,category:e.category})}else{let o=Ybigh.colorctx.createLinearGradient(0,320,0,580);o.addColorStop(1,"#c5ff52"),o.addColorStop(0,"white"),Ybigh.colorctx.beginPath(),Ybigh.colorctx.moveTo(185,510),Ybigh.colorctx.lineTo(265,335),Ybigh.colorctx.lineTo(305,335),Ybigh.colorctx.lineTo(380,510),Ybigh.colorctx.closePath(),Ybigh.colorctx.fillStyle=o,Ybigh.colorctx.strokeStyle="#D0D0D0",Ybigh.colorctx.stroke(),Ybigh.colorctx.fill(),Ybigh.click_counter+=1,e.name=Ybigh.current,e.category=1,Ybigh.yellow=e,Ybigh.colorctx.setTransform(1,0,0,1,0,0),Ybigh.colorctx.fillStyle="#000000",Ybigh.colorctx.fillRect(e.x-2,e.y-2,4,4),Ybigh.counter_hash.push({count:Ybigh.click_counter,category:e.category})}$(".cl."+Ybigh.paths[g].objID).css({"background-color":e.c})}else if(Ybigh.blue||Ybigh.red||Ybigh.green||Ybigh.yellow){$("#word_list li").removeClass("active");var b=parseInt($("#"+Ybigh.current).attr("data")),s=$("#word_list").find("[data='"+b+"']")[0],Y=b+1,u=$("#word_list").find("[data='"+Y+"']")[0];if(Ybigh.checkIfDone(u))$(u).addClass("active"),Ybigh.next(u,s),b>18&&$("#word_list").scrollTo("+=35",800);else{var d=Y+1,x=$("#word_list").find("[data='"+d+"']")[0];$(x).addClass("active"),Ybigh.next(x,s),d>18&&$("#word_list").scrollTo("+=35",800)}}}),Ybigh.$colors.on("mousemove",function(e){e.preventDefault();let o=parseInt(e.clientX-c),t=parseInt(e.clientY-l);for(var i=0;i<Ybigh.paths.length;i++){Ybigh.colorctx.isPointInPath(Ybigh.paths[i],o,t)&&Ybigh.$colors.css("cursor","crosshair")}})},checkIfDone:function(e){return"make-bold"!==$(e).attr("class")},bind_inputs:function(e){$("#overlay").css("display","block"),$.get("/Stage1/data",function(e){var o;Ybigh.data=e.data,Ybigh.show(),$("#clear").click(Ybigh.clear),$("#done").click(Ybigh.done),$("#removeSelections").click(Ybigh.submitCleared);var t=$("#word_list");$.each(Ybigh.data,function(e,c){var l=$('<li data="'+e+'" id="'+this+'">'+this+"</li>").on("touchstart mouseup",function(){if($("#removeSelections").prop("disabled",!0),$("#word_list li").removeClass("active"),"make-bold"===$(this).attr("class"))return Ybigh.blue||Ybigh.green||Ybigh.red||Ybigh.yellow?($(o).addClass("active"),void alert("Clear or submit active symbol before viewing another symbol")):($(this).addClass("active"),Ybigh.getPreviousState(this),void(o=this));Ybigh.current=$(this).html(),$(".word").val($(this).html().toUpperCase()),$(this).addClass("active"),(Ybigh.blue||Ybigh.green||Ybigh.red||Ybigh.yellow)&&Ybigh.current!==$(o).html()&&Ybigh.next(this,o),o=this});t.append(l)}),$("#overlay").css("display","none")})},next:function(e,o){$(".cl.world").css({"background-color":"white"}),$(".cl.others").css({"background-color":"white"}),$(".cl.activities").css({"background-color":"white"}),$(".cl.himself").css({"background-color":"white"}),Ybigh.close();let t=Ybigh.counter_hash.filter(function(e,o,t){return t.findIndex(function(o){return o.category==e.category})===o}).map(function(e){return{count:Ybigh.counter_hash.filter(function(o){return o.category==e.category}).reduce(function(e,o){return o.count<e?o.count:e}).count,category:e.category}});for(var c=0;c<t.length;c++)Ybigh.yellow&&Ybigh.yellow.category===t[c].category&&(Ybigh.yellow.clicked=t[c].count,Ybigh.saveSelection.push(Ybigh.yellow)),Ybigh.green&&Ybigh.green.category===t[c].category&&(Ybigh.green.clicked=t[c].count,Ybigh.saveSelection.push(Ybigh.green)),Ybigh.red&&Ybigh.red.category===t[c].category&&(Ybigh.red.clicked=t[c].count,Ybigh.saveSelection.push(Ybigh.red)),Ybigh.blue&&Ybigh.blue.category===t[c].category&&(Ybigh.blue.clicked=t[c].count,Ybigh.saveSelection.push(Ybigh.blue));Ybigh.saveSelection.sort(function(e,o){return e.count-o.count}),Ybigh.submit(Ybigh.saveSelection,e,o),Ybigh.saveSelection.length=0,Ybigh.blue=null,Ybigh.green=null,Ybigh.red=null,Ybigh.yellow=null},getPreviousState:function(e){for(var o=$(e).html(),t=[{c:"#81dea2",x:329,y:92,percentx:59.49367088607595,percenty:16.636528028933093,name:o,category:2,clicked:1},{c:"#cadbff",x:451,y:278,percentx:81.55515370705244,percenty:50.27124773960217,name:o,category:8,clicked:2},{c:"#ffe3e2",x:156,y:283,percentx:28.20976491862568,percenty:51.17540687160941,name:o,category:4,clicked:3},{c:"#e0ffa2",x:266,y:489,percentx:48.10126582278481,percenty:88.42676311030742,name:o,category:1,clicked:4}],c=0;c<t.length;c++)switch(Ybigh.colorctx.setTransform(1,0,0,1,0,0),Ybigh.colorctx.fillStyle="#000000",Ybigh.colorctx.fillRect(t[c].x-2,t[c].y-2,4,4),t[c].category){case 1:$(".cl.himself").css({"background-color":t[c].c}),Ybigh.yellow=t[c],Ybigh.counter_hash.push({count:t[c].click,category:t[c].category});break;case 2:$(".cl.others").css({"background-color":t[c].c}),Ybigh.green=t[c],Ybigh.counter_hash.push({count:t[c].click,category:t[c].category});break;case 4:$(".cl.activities").css({"background-color":t[c].c}),Ybigh.red=t[c],Ybigh.counter_hash.push({count:t[c].click,category:t[c].category});break;case 8:$(".cl.world").css({"background-color":t[c].c}),Ybigh.blue=t[c],Ybigh.counter_hash.push({count:t[c].click,category:t[c].category})}Ybigh.current=o,$(".word").val(o.toUpperCase())},done:function(e){(Ybigh.yellow||Ybigh.blue||Ybigh.red||Ybigh.green)&&Ybigh.next(),window.location.href="/Stage2"},submit:function(e,o,t){$("#overlay").css("display","block"),$.ajax({type:"POST",url:"/symbol",data:JSON.stringify(e),error:function(e,o,t){$("#overlay").css("display","none")},success:function(c){e.length=0,Ybigh.counter+=1,o&&t?(Ybigh.current=$(o).html(),$(".word").val($(o).html().toUpperCase()),$(t).addClass("make-bold")):$(t).addClass("make-bold"),Ybigh.counter>3&&$("#done").prop("disabled",!1).removeClass("dis"),$("#overlay").css("display","none")}})},close:function(){Ybigh.$colors.fadeOut(Ybigh.$colors.remove),Ybigh.startCounter()},get_color:function(e){var o=e.pageX-Ybigh.$colors.offset().left,t=e.pageY-Ybigh.$colors.offset().top,c=Ybigh.colorctx.getImageData(o,t,1,1).data,l=o/$("#can").width()*100,i=t/$("#can").height()*100;return{c:"#"+Ybigh.to_hex(c[0])+Ybigh.to_hex(c[1])+Ybigh.to_hex(c[2]),x:o,y:t,percentx:l,percenty:i}},render:function(e){var o,t=[{nameID:"others",col1:"white",col2:"#0fc14e",x:190,y:50,xlt:270,ylt:235,xlt1:310,ylt1:235,xlt2:380,ylt2:50,sx:0,fx:195,labelX:185,labelY:35,label:"Man's Connections with Other than Himself"},{nameID:"activities",col1:"#ff5f57",col2:"white",x:20,y:185,xlt:200,ylt:265,xlt1:200,ylt1:300,xlt2:20,ylt2:380,sx:190,fx:0,labelX:20,labelY:170,label:"Man's Physical Activities"},{nameID:"world",col1:"white",col2:"#4f87ff",x:550,y:185,xlt:370,ylt:265,xlt1:370,ylt1:300,xlt2:550,ylt2:380,sx:630,fx:375,labelX:405,labelY:170,label:"Man's View of the World"},{nameID:"himself",col1:"#c5ff52",col2:"white",x:185,y:510,xlt:265,ylt:335,xlt1:305,ylt1:335,xlt2:380,ylt2:510,sx:320,fx:580,labelX:220,labelY:540,label:"Man's View of Himself"}];Path2D.prototype.getID=function(e){this.objID=e};for(var c=0;c<t.length;c++){(o="others"==t[c].nameID||"himself"==t[c].nameID?Ybigh.colorctx.createLinearGradient(0,t[c].sx,0,t[c].fx):Ybigh.colorctx.createLinearGradient(t[c].sx,0,t[c].fx,0)).addColorStop(1,t[c].col1),o.addColorStop(0,t[c].col2);var l=new Path2D;l.moveTo(t[c].x,t[c].y),l.lineTo(t[c].xlt,t[c].ylt),l.lineTo(t[c].xlt1,t[c].ylt1),l.lineTo(t[c].xlt2,t[c].ylt2),l.closePath(),l.getID(t[c].nameID),Ybigh.colorctx.fillStyle=o,Ybigh.colorctx.strokeStyle="#D0D0D0",Ybigh.colorctx.stroke(l),Ybigh.colorctx.fill(l),e&&(Ybigh.paths.push(l),Ybigh.colorctx.strokeStyle="black",Ybigh.colorctx.font="11px verdana",Ybigh.colorctx.strokeText(t[c].label,t[c].labelX,t[c].labelY))}}},Ybigh.bind_inputs();